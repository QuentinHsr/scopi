

def convert(string):
    return string.replace("Abs","np.abs").replace("sin","np.sin")\
            .replace("cos","np.cos").replace("sign","np.sign")\
            .replace("sqrt","np.sqrt")



r0 = "res_ref[0] = -(s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1zc + s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2zc) + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1yc + s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2yc)"

r1 = "res_ref[1] = (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1zc + s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2zc) - (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1xc + s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2xc)"

r2 = "res_ref[2] = (s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1xc + s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2xc) - (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1yc + s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2yc)"

r3 = "res_ref[3] = (s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2))) + (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2))) + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2))) + sqrt((s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2 + (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2 + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2)*sqrt((s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2 + (s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2 + (s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2)"






dr00 = "res_ref[0,0] = (-s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) - s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s1n*s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(a1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))**2*sign(cos(b1))/Abs(cos(a1)) + s1n*s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*sin(a1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1))**2/Abs(cos(a1)) - s1n*s1rz*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*cos(a1)*Abs(sin(a1))**s1n*sign(sin(a1))**2/Abs(sin(a1)) + 2*s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(a1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*DiracDelta(cos(a1))*sign(cos(b1)) + 2*s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*sin(a1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*DiracDelta(cos(a1))*sign(sin(b1)) - 2*s1rz*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*cos(a1)*Abs(sin(a1))**s1n*DiracDelta(sin(a1))) + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s1n*s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))**2*sign(cos(b1))/Abs(cos(a1)) + s1n*s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*sin(a1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1))**2/Abs(cos(a1)) - s1n*s1rz*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(a1)*Abs(sin(a1))**s1n*sign(sin(a1))**2/Abs(sin(a1)) + 2*s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*DiracDelta(cos(a1))*sign(cos(b1)) + 2*s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*sin(a1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*DiracDelta(cos(a1))*sign(sin(b1)) - 2*s1rz*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(a1)*Abs(sin(a1))**s1n*DiracDelta(sin(a1))) + (-s1rx*s1ry*(2 - s1n)*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))**2*sign(cos(a1))/Abs(sin(a1)) + 2*s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*sin(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(cos(a1))*sign(sin(a1)) - 2*s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2 - s1n)*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*sin(a1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))*sign(cos(a1))/Abs(cos(a1)) + s1ry*s1rz*(2 - s1n)*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(a1))*sign(cos(b1))/Abs(cos(a1)))*(-s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1zc + s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2zc) + (s1rx*s1ry*(2 - s1n)*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*cos(a1)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))**2*sign(cos(a1))/Abs(sin(a1)) - 2*s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*sin(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(cos(a1))*sign(sin(a1)) + 2*s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*cos(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(2 - s1n)*(2*s1q0*s1q1 + 2*s1q2*s1q3)*sin(a1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))*sign(cos(a1))/Abs(cos(a1)) - s1ry*s1rz*(2 - s1n)*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(a1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(a1))*sign(cos(b1))/Abs(cos(a1)))*(-s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1yc + s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2yc)"

dr01 = "res_ref[0,1] = (-s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) - s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s1e*s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(b1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1))**2/Abs(cos(b1)) - s1e*s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(b1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))**2*sign(cos(a1))/Abs(sin(b1)) + 2*s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(b1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*DiracDelta(cos(b1))*sign(cos(a1)) - 2*s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(b1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*DiracDelta(sin(b1))*sign(cos(a1))) + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s1e*s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(b1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1))**2/Abs(cos(b1)) - s1e*s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*cos(b1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))**2*sign(cos(a1))/Abs(sin(b1)) + 2*s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(b1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*DiracDelta(cos(b1))*sign(cos(a1)) - 2*s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*cos(b1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*DiracDelta(sin(b1))*sign(cos(a1))) + (s1rx*s1rz*(2 - s1e)*(2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))**2/Abs(sin(b1)) + 2*s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*DiracDelta(sin(b1)) - s1ry*s1rz*(2 - s1e)*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1))**2/Abs(cos(b1)) - 2*s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*DiracDelta(cos(b1)))*(-s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1yc + s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2yc) + (-s1rx*s1rz*(2 - s1e)*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))**2/Abs(sin(b1)) - 2*s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*DiracDelta(sin(b1)) + s1ry*s1rz*(2 - s1e)*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1))**2/Abs(cos(b1)) + 2*s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*DiracDelta(cos(b1)))*(-s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1zc + s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2zc)"

dr02 = "res_ref[0,2] = (-s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) - s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s2n*s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(a2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))**2*sign(cos(b2))/Abs(cos(a2)) - s2n*s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*sin(a2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2))**2/Abs(cos(a2)) + s2n*s2rz*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*cos(a2)*Abs(sin(a2))**s2n*sign(sin(a2))**2/Abs(sin(a2)) - 2*s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(a2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*DiracDelta(cos(a2))*sign(cos(b2)) - 2*s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*sin(a2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*DiracDelta(cos(a2))*sign(sin(b2)) + 2*s2rz*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*cos(a2)*Abs(sin(a2))**s2n*DiracDelta(sin(a2))) + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s2n*s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(a2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))**2*sign(cos(b2))/Abs(cos(a2)) - s2n*s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*sin(a2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2))**2/Abs(cos(a2)) + s2n*s2rz*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(a2)*Abs(sin(a2))**s2n*sign(sin(a2))**2/Abs(sin(a2)) - 2*s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(a2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*DiracDelta(cos(a2))*sign(cos(b2)) - 2*s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*sin(a2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*DiracDelta(cos(a2))*sign(sin(b2)) + 2*s2rz*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(a2)*Abs(sin(a2))**s2n*DiracDelta(sin(a2)))"

dr03 = "res_ref[0,3] = (-s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) - s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s2e*s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(b2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2))**2/Abs(cos(b2)) + s2e*s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(b2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))**2*sign(cos(a2))/Abs(sin(b2)) - 2*s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(b2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*DiracDelta(cos(b2))*sign(cos(a2)) + 2*s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(b2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*DiracDelta(sin(b2))*sign(cos(a2))) + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s2e*s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(b2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2))**2/Abs(cos(b2)) + s2e*s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*cos(b2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))**2*sign(cos(a2))/Abs(sin(b2)) - 2*s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(b2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*DiracDelta(cos(b2))*sign(cos(a2)) + 2*s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*cos(b2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*DiracDelta(sin(b2))*sign(cos(a2)))"

dr10 = "res_ref[1,0] = (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s1n*s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(a1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))**2*sign(cos(b1))/Abs(cos(a1)) + s1n*s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*sin(a1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1))**2/Abs(cos(a1)) - s1n*s1rz*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*cos(a1)*Abs(sin(a1))**s1n*sign(sin(a1))**2/Abs(sin(a1)) + 2*s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(a1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*DiracDelta(cos(a1))*sign(cos(b1)) + 2*s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*sin(a1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*DiracDelta(cos(a1))*sign(sin(b1)) - 2*s1rz*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*cos(a1)*Abs(sin(a1))**s1n*DiracDelta(sin(a1))) + (-s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) - s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s1n*s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(a1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))**2*sign(cos(b1))/Abs(cos(a1)) + s1n*s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1))**2/Abs(cos(a1)) - s1n*s1rz*(2*s1q0*s1q2 + 2*s1q1*s1q3)*cos(a1)*Abs(sin(a1))**s1n*sign(sin(a1))**2/Abs(sin(a1)) + 2*s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(a1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*DiracDelta(cos(a1))*sign(cos(b1)) + 2*s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*DiracDelta(cos(a1))*sign(sin(b1)) - 2*s1rz*(2*s1q0*s1q2 + 2*s1q1*s1q3)*cos(a1)*Abs(sin(a1))**s1n*DiracDelta(sin(a1))) + (s1rx*s1ry*(2 - s1n)*(2*s1q0*s1q2 + 2*s1q1*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))**2*sign(cos(a1))/Abs(sin(a1)) - 2*s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(cos(a1))*sign(sin(a1)) + 2*s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(2 - s1n)*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))*sign(cos(a1))/Abs(cos(a1)) - s1ry*s1rz*(2 - s1n)*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(a1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(a1))*sign(cos(b1))/Abs(cos(a1)))*(-s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1zc + s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2zc) + (-s1rx*s1ry*(2 - s1n)*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*cos(a1)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))**2*sign(cos(a1))/Abs(sin(a1)) + 2*s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*sin(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(cos(a1))*sign(sin(a1)) - 2*s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*cos(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2 - s1n)*(2*s1q0*s1q1 + 2*s1q2*s1q3)*sin(a1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))*sign(cos(a1))/Abs(cos(a1)) + s1ry*s1rz*(2 - s1n)*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(a1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(a1))*sign(cos(b1))/Abs(cos(a1)))*(-s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1xc + s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2xc)"

dr11 = "res_ref[1,1] = (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s1e*s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(b1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1))**2/Abs(cos(b1)) - s1e*s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(b1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))**2*sign(cos(a1))/Abs(sin(b1)) + 2*s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(b1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*DiracDelta(cos(b1))*sign(cos(a1)) - 2*s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(b1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*DiracDelta(sin(b1))*sign(cos(a1))) + (-s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) - s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s1e*s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(b1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1))**2/Abs(cos(b1)) - s1e*s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*cos(b1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))**2*sign(cos(a1))/Abs(sin(b1)) + 2*s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(b1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*DiracDelta(cos(b1))*sign(cos(a1)) - 2*s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*cos(b1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*DiracDelta(sin(b1))*sign(cos(a1))) + (-s1rx*s1rz*(2 - s1e)*(2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))**2/Abs(sin(b1)) - 2*s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*DiracDelta(sin(b1)) + s1ry*s1rz*(2 - s1e)*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1))**2/Abs(cos(b1)) + 2*s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*DiracDelta(cos(b1)))*(-s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1xc + s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2xc) + (s1rx*s1rz*(2 - s1e)*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))**2/Abs(sin(b1)) + 2*s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*DiracDelta(sin(b1)) - s1ry*s1rz*(2 - s1e)*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1))**2/Abs(cos(b1)) - 2*s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*DiracDelta(cos(b1)))*(-s1rx*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1zc + s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2zc)"

dr12 = "res_ref[1,2] = (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s2n*s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(a2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))**2*sign(cos(b2))/Abs(cos(a2)) - s2n*s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*sin(a2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2))**2/Abs(cos(a2)) + s2n*s2rz*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*cos(a2)*Abs(sin(a2))**s2n*sign(sin(a2))**2/Abs(sin(a2)) - 2*s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(a2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*DiracDelta(cos(a2))*sign(cos(b2)) - 2*s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*sin(a2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*DiracDelta(cos(a2))*sign(sin(b2)) + 2*s2rz*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*cos(a2)*Abs(sin(a2))**s2n*DiracDelta(sin(a2))) + (-s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) - s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s2n*s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(a2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))**2*sign(cos(b2))/Abs(cos(a2)) - s2n*s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(a2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2))**2/Abs(cos(a2)) + s2n*s2rz*(2*s2q0*s2q2 + 2*s2q1*s2q3)*cos(a2)*Abs(sin(a2))**s2n*sign(sin(a2))**2/Abs(sin(a2)) - 2*s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(a2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*DiracDelta(cos(a2))*sign(cos(b2)) - 2*s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(a2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*DiracDelta(cos(a2))*sign(sin(b2)) + 2*s2rz*(2*s2q0*s2q2 + 2*s2q1*s2q3)*cos(a2)*Abs(sin(a2))**s2n*DiracDelta(sin(a2)))"

dr13 = "res_ref[1,3] = (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s2e*s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(b2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2))**2/Abs(cos(b2)) + s2e*s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(b2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))**2*sign(cos(a2))/Abs(sin(b2)) - 2*s2rx*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(b2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*DiracDelta(cos(b2))*sign(cos(a2)) + 2*s2ry*(2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(b2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*DiracDelta(sin(b2))*sign(cos(a2))) + (-s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) - s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s2e*s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(b2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2))**2/Abs(cos(b2)) + s2e*s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*cos(b2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))**2*sign(cos(a2))/Abs(sin(b2)) - 2*s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(b2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*DiracDelta(cos(b2))*sign(cos(a2)) + 2*s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*cos(b2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*DiracDelta(sin(b2))*sign(cos(a2)))"

dr20 = "res_ref[2,0] = (s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s1n*s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(a1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))**2*sign(cos(b1))/Abs(cos(a1)) + s1n*s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1))**2/Abs(cos(a1)) - s1n*s1rz*(2*s1q0*s1q2 + 2*s1q1*s1q3)*cos(a1)*Abs(sin(a1))**s1n*sign(sin(a1))**2/Abs(sin(a1)) + 2*s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(a1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*DiracDelta(cos(a1))*sign(cos(b1)) + 2*s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*DiracDelta(cos(a1))*sign(sin(b1)) - 2*s1rz*(2*s1q0*s1q2 + 2*s1q1*s1q3)*cos(a1)*Abs(sin(a1))**s1n*DiracDelta(sin(a1))) + (-s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) - s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s1n*s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))**2*sign(cos(b1))/Abs(cos(a1)) + s1n*s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*sin(a1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1))**2/Abs(cos(a1)) - s1n*s1rz*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(a1)*Abs(sin(a1))**s1n*sign(sin(a1))**2/Abs(sin(a1)) + 2*s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*DiracDelta(cos(a1))*sign(cos(b1)) + 2*s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*sin(a1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*DiracDelta(cos(a1))*sign(sin(b1)) - 2*s1rz*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(a1)*Abs(sin(a1))**s1n*DiracDelta(sin(a1))) + (s1rx*s1ry*(2 - s1n)*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))**2*sign(cos(a1))/Abs(sin(a1)) - 2*s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*sin(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(cos(a1))*sign(sin(a1)) + 2*s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(2 - s1n)*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*sin(a1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))*sign(cos(a1))/Abs(cos(a1)) - s1ry*s1rz*(2 - s1n)*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(a1))*sign(cos(b1))/Abs(cos(a1)))*(-s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1xc + s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2xc) + (-s1rx*s1ry*(2 - s1n)*(2*s1q0*s1q2 + 2*s1q1*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))**2*sign(cos(a1))/Abs(sin(a1)) + 2*s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(cos(a1))*sign(sin(a1)) - 2*s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2 - s1n)*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))*sign(cos(a1))/Abs(cos(a1)) + s1ry*s1rz*(2 - s1n)*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(a1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(a1))*sign(cos(b1))/Abs(cos(a1)))*(-s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1yc + s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2yc)"

dr21 = "res_ref[2,1] = (s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s1e*s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(b1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1))**2/Abs(cos(b1)) - s1e*s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*cos(b1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))**2*sign(cos(a1))/Abs(sin(b1)) + 2*s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(b1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*DiracDelta(cos(b1))*sign(cos(a1)) - 2*s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*cos(b1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*DiracDelta(sin(b1))*sign(cos(a1))) + (-s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) - s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s1e*s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(b1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1))**2/Abs(cos(b1)) - s1e*s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*cos(b1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))**2*sign(cos(a1))/Abs(sin(b1)) + 2*s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(b1)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*DiracDelta(cos(b1))*sign(cos(a1)) - 2*s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*cos(b1)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*DiracDelta(sin(b1))*sign(cos(a1))) + (-s1rx*s1rz*(2 - s1e)*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))**2/Abs(sin(b1)) - 2*s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*DiracDelta(sin(b1)) + s1ry*s1rz*(2 - s1e)*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1))**2/Abs(cos(b1)) + 2*s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*DiracDelta(cos(b1)))*(-s1rx*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1yc + s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2yc) + (s1rx*s1rz*(2 - s1e)*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))**2/Abs(sin(b1)) + 2*s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*DiracDelta(sin(b1)) - s1ry*s1rz*(2 - s1e)*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1))**2/Abs(cos(b1)) - 2*s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*DiracDelta(cos(b1)))*(-s1rx*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**s1n*Abs(cos(b1))**s1e*sign(cos(a1))*sign(cos(b1)) - s1ry*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**s1e*Abs(cos(a1))**s1n*sign(sin(b1))*sign(cos(a1)) - s1rz*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**s1n*sign(sin(a1)) - s1xc + s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2)) + s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2)) + s2rz*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**s2n*sign(sin(a2)) + s2xc)"

dr22 = "res_ref[2,2] = (s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s2n*s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(a2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))**2*sign(cos(b2))/Abs(cos(a2)) - s2n*s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(a2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2))**2/Abs(cos(a2)) + s2n*s2rz*(2*s2q0*s2q2 + 2*s2q1*s2q3)*cos(a2)*Abs(sin(a2))**s2n*sign(sin(a2))**2/Abs(sin(a2)) - 2*s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(a2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*DiracDelta(cos(a2))*sign(cos(b2)) - 2*s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(a2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*DiracDelta(cos(a2))*sign(sin(b2)) + 2*s2rz*(2*s2q0*s2q2 + 2*s2q1*s2q3)*cos(a2)*Abs(sin(a2))**s2n*DiracDelta(sin(a2))) + (-s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) - s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s2n*s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(a2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))**2*sign(cos(b2))/Abs(cos(a2)) - s2n*s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*sin(a2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))*sign(cos(a2))**2/Abs(cos(a2)) + s2n*s2rz*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(a2)*Abs(sin(a2))**s2n*sign(sin(a2))**2/Abs(sin(a2)) - 2*s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(a2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*DiracDelta(cos(a2))*sign(cos(b2)) - 2*s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*sin(a2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*DiracDelta(cos(a2))*sign(sin(b2)) + 2*s2rz*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(a2)*Abs(sin(a2))**s2n*DiracDelta(sin(a2)))"

dr23 = "res_ref[2,3] = (s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s2e*s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(b2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2))**2/Abs(cos(b2)) + s2e*s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*cos(b2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))**2*sign(cos(a2))/Abs(sin(b2)) - 2*s2rx*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(b2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*DiracDelta(cos(b2))*sign(cos(a2)) + 2*s2ry*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*cos(b2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*DiracDelta(sin(b2))*sign(cos(a2))) + (-s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) - s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(-s2e*s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(b2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*sign(cos(a2))*sign(cos(b2))**2/Abs(cos(b2)) + s2e*s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*cos(b2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*sign(sin(b2))**2*sign(cos(a2))/Abs(sin(b2)) - 2*s2rx*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(b2)*Abs(cos(a2))**s2n*Abs(cos(b2))**s2e*DiracDelta(cos(b2))*sign(cos(a2)) + 2*s2ry*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*cos(b2)*Abs(sin(b2))**s2e*Abs(cos(a2))**s2n*DiracDelta(sin(b2))*sign(cos(a2)))"

dr30 = "res_ref[3,0] = ((s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(2*s1rx*s1ry*(2 - s1n)*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))**2*sign(cos(a1))/Abs(sin(a1)) - 4*s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*sin(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(cos(a1))*sign(sin(a1)) + 4*s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(sin(a1))*sign(cos(a1)) - 2*s1rx*s1rz*(2 - s1n)*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*sin(a1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))*sign(cos(a1))/Abs(cos(a1)) - 2*s1ry*s1rz*(2 - s1n)*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(a1))*sign(cos(b1))/Abs(cos(a1)))/2 + (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(2*s1rx*s1ry*(2 - s1n)*(2*s1q0*s1q2 + 2*s1q1*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))**2*sign(cos(a1))/Abs(sin(a1)) - 4*s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(cos(a1))*sign(sin(a1)) + 4*s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(sin(a1))*sign(cos(a1)) - 2*s1rx*s1rz*(2 - s1n)*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))*sign(cos(a1))/Abs(cos(a1)) - 2*s1ry*s1rz*(2 - s1n)*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(a1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(a1))*sign(cos(b1))/Abs(cos(a1)))/2 + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(2*s1rx*s1ry*(2 - s1n)*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*cos(a1)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))**2*sign(cos(a1))/Abs(sin(a1)) - 4*s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*sin(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(cos(a1))*sign(sin(a1)) + 4*s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*cos(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(sin(a1))*sign(cos(a1)) - 2*s1rx*s1rz*(2 - s1n)*(2*s1q0*s1q1 + 2*s1q2*s1q3)*sin(a1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))*sign(cos(a1))/Abs(cos(a1)) - 2*s1ry*s1rz*(2 - s1n)*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(a1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(a1))*sign(cos(b1))/Abs(cos(a1)))/2)*sqrt((s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2 + (s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2 + (s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2)/sqrt((s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2 + (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2 + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2) + (s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))*(s1rx*s1ry*(2 - s1n)*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))**2*sign(cos(a1))/Abs(sin(a1)) - 2*s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*sin(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(cos(a1))*sign(sin(a1)) + 2*s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(2 - s1n)*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*sin(a1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))*sign(cos(a1))/Abs(cos(a1)) - s1ry*s1rz*(2 - s1n)*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(a1))*sign(cos(b1))/Abs(cos(a1))) + (s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))*(s1rx*s1ry*(2 - s1n)*(2*s1q0*s1q2 + 2*s1q1*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))**2*sign(cos(a1))/Abs(sin(a1)) - 2*s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(cos(a1))*sign(sin(a1)) + 2*s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*cos(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(2 - s1n)*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(a1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))*sign(cos(a1))/Abs(cos(a1)) - s1ry*s1rz*(2 - s1n)*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(a1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(a1))*sign(cos(b1))/Abs(cos(a1))) + (s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))*(s1rx*s1ry*(2 - s1n)*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*cos(a1)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))**2*sign(cos(a1))/Abs(sin(a1)) - 2*s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*sin(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(cos(a1))*sign(sin(a1)) + 2*s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*cos(a1)*Abs(sin(a1))**(2 - s1n)*DiracDelta(sin(a1))*sign(cos(a1)) - s1rx*s1rz*(2 - s1n)*(2*s1q0*s1q1 + 2*s1q2*s1q3)*sin(a1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))*sign(cos(a1))/Abs(cos(a1)) - s1ry*s1rz*(2 - s1n)*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(a1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(a1))*sign(cos(b1))/Abs(cos(a1)))"

dr31 = "res_ref[3,1] = ((s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(2*s1rx*s1rz*(2 - s1e)*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))**2/Abs(sin(b1)) + 4*s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*DiracDelta(sin(b1)) - 2*s1ry*s1rz*(2 - s1e)*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1))**2/Abs(cos(b1)) - 4*s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*DiracDelta(cos(b1)))/2 + (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(2*s1rx*s1rz*(2 - s1e)*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))**2/Abs(sin(b1)) + 4*s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*DiracDelta(sin(b1)) - 2*s1ry*s1rz*(2 - s1e)*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1))**2/Abs(cos(b1)) - 4*s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*DiracDelta(cos(b1)))/2 + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(2*s1rx*s1rz*(2 - s1e)*(2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))**2/Abs(sin(b1)) + 4*s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*DiracDelta(sin(b1)) - 2*s1ry*s1rz*(2 - s1e)*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1))**2/Abs(cos(b1)) - 4*s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*DiracDelta(cos(b1)))/2)*sqrt((s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2 + (s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2 + (s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2)/sqrt((s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2 + (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2 + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2) + (s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))*(s1rx*s1rz*(2 - s1e)*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))**2/Abs(sin(b1)) + 2*s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*DiracDelta(sin(b1)) - s1ry*s1rz*(2 - s1e)*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1))**2/Abs(cos(b1)) - 2*s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*DiracDelta(cos(b1))) + (s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))*(s1rx*s1rz*(2 - s1e)*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))**2/Abs(sin(b1)) + 2*s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*DiracDelta(sin(b1)) - s1ry*s1rz*(2 - s1e)*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1))**2/Abs(cos(b1)) - 2*s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*DiracDelta(cos(b1))) + (s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))*(s1rx*s1rz*(2 - s1e)*(2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1))**2/Abs(sin(b1)) + 2*s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*cos(b1)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*DiracDelta(sin(b1)) - s1ry*s1rz*(2 - s1e)*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1))**2/Abs(cos(b1)) - 2*s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*sin(b1)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*DiracDelta(cos(b1)))"

dr32 = "res_ref[3,2] = ((s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))*(2*s2rx*s2ry*(2 - s2n)*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(a2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))**2*sign(cos(a2))/Abs(sin(a2)) - 4*s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*sin(a2)*Abs(sin(a2))**(2 - s2n)*DiracDelta(cos(a2))*sign(sin(a2)) + 4*s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(a2)*Abs(sin(a2))**(2 - s2n)*DiracDelta(sin(a2))*sign(cos(a2)) - 2*s2rx*s2rz*(2 - s2n)*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*sin(a2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2))*sign(cos(a2))/Abs(cos(a2)) - 2*s2ry*s2rz*(2 - s2n)*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(a2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(a2))*sign(cos(b2))/Abs(cos(a2)))/2 + (s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))*(2*s2rx*s2ry*(2 - s2n)*(2*s2q0*s2q2 + 2*s2q1*s2q3)*cos(a2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))**2*sign(cos(a2))/Abs(sin(a2)) - 4*s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(a2)*Abs(sin(a2))**(2 - s2n)*DiracDelta(cos(a2))*sign(sin(a2)) + 4*s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*cos(a2)*Abs(sin(a2))**(2 - s2n)*DiracDelta(sin(a2))*sign(cos(a2)) - 2*s2rx*s2rz*(2 - s2n)*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(a2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2))*sign(cos(a2))/Abs(cos(a2)) - 2*s2ry*s2rz*(2 - s2n)*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(a2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(a2))*sign(cos(b2))/Abs(cos(a2)))/2 + (s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))*(2*s2rx*s2ry*(2 - s2n)*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*cos(a2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))**2*sign(cos(a2))/Abs(sin(a2)) - 4*s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*sin(a2)*Abs(sin(a2))**(2 - s2n)*DiracDelta(cos(a2))*sign(sin(a2)) + 4*s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*cos(a2)*Abs(sin(a2))**(2 - s2n)*DiracDelta(sin(a2))*sign(cos(a2)) - 2*s2rx*s2rz*(2 - s2n)*(2*s2q0*s2q1 + 2*s2q2*s2q3)*sin(a2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2))*sign(cos(a2))/Abs(cos(a2)) - 2*s2ry*s2rz*(2 - s2n)*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(a2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(a2))*sign(cos(b2))/Abs(cos(a2)))/2)*sqrt((s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2 + (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2 + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2)/sqrt((s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2 + (s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2 + (s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2) + (s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s2rx*s2ry*(2 - s2n)*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(a2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))**2*sign(cos(a2))/Abs(sin(a2)) - 2*s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*sin(a2)*Abs(sin(a2))**(2 - s2n)*DiracDelta(cos(a2))*sign(sin(a2)) + 2*s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(a2)*Abs(sin(a2))**(2 - s2n)*DiracDelta(sin(a2))*sign(cos(a2)) - s2rx*s2rz*(2 - s2n)*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*sin(a2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2))*sign(cos(a2))/Abs(cos(a2)) - s2ry*s2rz*(2 - s2n)*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(a2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(a2))*sign(cos(b2))/Abs(cos(a2))) + (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s2rx*s2ry*(2 - s2n)*(2*s2q0*s2q2 + 2*s2q1*s2q3)*cos(a2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))**2*sign(cos(a2))/Abs(sin(a2)) - 2*s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(a2)*Abs(sin(a2))**(2 - s2n)*DiracDelta(cos(a2))*sign(sin(a2)) + 2*s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*cos(a2)*Abs(sin(a2))**(2 - s2n)*DiracDelta(sin(a2))*sign(cos(a2)) - s2rx*s2rz*(2 - s2n)*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(a2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2))*sign(cos(a2))/Abs(cos(a2)) - s2ry*s2rz*(2 - s2n)*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(a2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(a2))*sign(cos(b2))/Abs(cos(a2))) + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s2rx*s2ry*(2 - s2n)*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*cos(a2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))**2*sign(cos(a2))/Abs(sin(a2)) - 2*s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*sin(a2)*Abs(sin(a2))**(2 - s2n)*DiracDelta(cos(a2))*sign(sin(a2)) + 2*s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*cos(a2)*Abs(sin(a2))**(2 - s2n)*DiracDelta(sin(a2))*sign(cos(a2)) - s2rx*s2rz*(2 - s2n)*(2*s2q0*s2q1 + 2*s2q2*s2q3)*sin(a2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2))*sign(cos(a2))/Abs(cos(a2)) - s2ry*s2rz*(2 - s2n)*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(a2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(a2))*sign(cos(b2))/Abs(cos(a2)))"

dr33 = "res_ref[3,3] = ((s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))*(2*s2rx*s2rz*(2 - s2e)*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*cos(b2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2))**2/Abs(sin(b2)) + 4*s2rx*s2rz*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*cos(b2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*DiracDelta(sin(b2)) - 2*s2ry*s2rz*(2 - s2e)*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(b2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2))**2/Abs(cos(b2)) - 4*s2ry*s2rz*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(b2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*DiracDelta(cos(b2)))/2 + (s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))*(2*s2rx*s2rz*(2 - s2e)*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*cos(b2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2))**2/Abs(sin(b2)) + 4*s2rx*s2rz*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*cos(b2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*DiracDelta(sin(b2)) - 2*s2ry*s2rz*(2 - s2e)*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(b2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2))**2/Abs(cos(b2)) - 4*s2ry*s2rz*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(b2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*DiracDelta(cos(b2)))/2 + (s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))*(2*s2rx*s2rz*(2 - s2e)*(2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(b2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2))**2/Abs(sin(b2)) + 4*s2rx*s2rz*(2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(b2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*DiracDelta(sin(b2)) - 2*s2ry*s2rz*(2 - s2e)*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(b2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2))**2/Abs(cos(b2)) - 4*s2ry*s2rz*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(b2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*DiracDelta(cos(b2)))/2)*sqrt((s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2 + (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2 + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))**2)/sqrt((s2rx*s2ry*(-2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2 + (s2rx*s2ry*(2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2 + (s2rx*s2ry*(s2q0**2 - s2q1**2 - s2q2**2 + s2q3**2)*Abs(sin(a2))**(2 - s2n)*sign(sin(a2))*sign(cos(a2)) + s2rx*s2rz*(2*s2q0*s2q1 + 2*s2q2*s2q3)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2)) + s2ry*s2rz*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2)))**2) + (s1rx*s1ry*(-2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(s1q0**2 - s1q1**2 + s1q2**2 - s1q3**2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s2rx*s2rz*(2 - s2e)*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*cos(b2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2))**2/Abs(sin(b2)) + 2*s2rx*s2rz*(s2q0**2 - s2q1**2 + s2q2**2 - s2q3**2)*cos(b2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*DiracDelta(sin(b2)) - s2ry*s2rz*(2 - s2e)*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(b2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2))**2/Abs(cos(b2)) - 2*s2ry*s2rz*(2*s2q0*s2q3 + 2*s2q1*s2q2)*sin(b2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*DiracDelta(cos(b2))) + (s1rx*s1ry*(2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(-2*s1q0*s1q3 + 2*s1q1*s1q2)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(s1q0**2 + s1q1**2 - s1q2**2 - s1q3**2)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s2rx*s2rz*(2 - s2e)*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*cos(b2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2))**2/Abs(sin(b2)) + 2*s2rx*s2rz*(-2*s2q0*s2q3 + 2*s2q1*s2q2)*cos(b2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*DiracDelta(sin(b2)) - s2ry*s2rz*(2 - s2e)*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(b2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2))**2/Abs(cos(b2)) - 2*s2ry*s2rz*(s2q0**2 + s2q1**2 - s2q2**2 - s2q3**2)*sin(b2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*DiracDelta(cos(b2))) + (s1rx*s1ry*(s1q0**2 - s1q1**2 - s1q2**2 + s1q3**2)*Abs(sin(a1))**(2 - s1n)*sign(sin(a1))*sign(cos(a1)) + s1rx*s1rz*(2*s1q0*s1q1 + 2*s1q2*s1q3)*Abs(sin(b1))**(2 - s1e)*Abs(cos(a1))**(2 - s1n)*sign(sin(b1)) + s1ry*s1rz*(-2*s1q0*s1q2 + 2*s1q1*s1q3)*Abs(cos(a1))**(2 - s1n)*Abs(cos(b1))**(2 - s1e)*sign(cos(b1)))*(s2rx*s2rz*(2 - s2e)*(2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(b2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*sign(sin(b2))**2/Abs(sin(b2)) + 2*s2rx*s2rz*(2*s2q0*s2q1 + 2*s2q2*s2q3)*cos(b2)*Abs(sin(b2))**(2 - s2e)*Abs(cos(a2))**(2 - s2n)*DiracDelta(sin(b2)) - s2ry*s2rz*(2 - s2e)*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(b2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*sign(cos(b2))**2/Abs(cos(b2)) - 2*s2ry*s2rz*(-2*s2q0*s2q2 + 2*s2q1*s2q3)*sin(b2)*Abs(cos(a2))**(2 - s2n)*Abs(cos(b2))**(2 - s2e)*DiracDelta(cos(b2)))"



# print("\n",convert(r0))
# print("\n",convert(r1))
# print("\n",convert(r2))
# print("\n",convert(r3))

print("\n",convert(dr00))
print("\n",convert(dr01))
print("\n",convert(dr02))
print("\n",convert(dr03))

print("\n",convert(dr10))
print("\n",convert(dr11))
print("\n",convert(dr12))
print("\n",convert(dr13))

print("\n",convert(dr20))
print("\n",convert(dr21))
print("\n",convert(dr22))
print("\n",convert(dr23))

print("\n",convert(dr30))
print("\n",convert(dr31))
print("\n",convert(dr32))
print("\n",convert(dr33))
